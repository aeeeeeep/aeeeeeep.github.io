<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>制作目标检测数据集常用python脚本整理 | Aeeeeeep Blog | The Gleaners</title><link rel="shortcut icon" href="/images/favicon64.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css"><script src="/js/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 5.4.2"></head><body><main class="content"><section class="outer"><article id="post-制作目标检测数据集常用python脚本整理" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">制作目标检测数据集常用python脚本整理</h1></header><div class="article-meta"><a href="/2022/04/09/%E5%88%B6%E4%BD%9C%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E6%95%B0%E6%8D%AE%E9%9B%86%E5%B8%B8%E7%94%A8python%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/" class="article-date"><time datetime="2022-04-09T01:17:43.000Z" itemprop="datePublished">2022-04-09</time></a><div class="article-category"><a class="article-category-link" href="/categories/%E6%87%B5%E9%80%BC%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">懵逼的深度学习</a></div></div><div class="tocbot"></div><div class="article-entry" itemprop="articleBody"><h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>制作个人目标检测数据集时，有查找爬取的错误图片，更改标注路径等等需要，写了以下python脚本</p><span id="more"></span><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><h3 id="查找错误图片"><a href="#查找错误图片" class="headerlink" title="查找错误图片"></a>查找错误图片</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> imghdr</span><br><span class="line"><span class="keyword">from</span> progressbar <span class="keyword">import</span> ProgressBar</span><br><span class="line"></span><br><span class="line">path =<span class="string">&#x27;./JPEGImages&#x27;</span></span><br><span class="line">original_images =[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root, dirs, filenames <span class="keyword">in</span> os.walk(path):</span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> filenames:</span><br><span class="line">        original_images.append(os.path.join(root, filename))</span><br><span class="line"></span><br><span class="line">original_images = <span class="built_in">sorted</span>(original_images)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;num:&#x27;</span>,<span class="built_in">len</span>(original_images))</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;check_error.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>)</span><br><span class="line">error_images =[]</span><br><span class="line">progress = ProgressBar()</span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> progress(original_images):</span><br><span class="line">    check = imghdr.what(filename)</span><br><span class="line">    <span class="keyword">if</span> check == <span class="literal">None</span>:</span><br><span class="line">        f.write(filename)</span><br><span class="line">        f.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        error_images.append(filename)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(error_images))</span><br><span class="line">f.seek(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h3 id="按顺序重命名标注文件和图片（分成两部分防止图片和标注文件数量不一致）"><a href="#按顺序重命名标注文件和图片（分成两部分防止图片和标注文件数量不一致）" class="headerlink" title="按顺序重命名标注文件和图片（分成两部分防止图片和标注文件数量不一致）"></a>按顺序重命名标注文件和图片（分成两部分防止图片和标注文件数量不一致）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BatchRename</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.path1 = <span class="string">&#x27;./JPEGImages&#x27;</span></span><br><span class="line">        self.path2 = <span class="string">&#x27;./Annotations&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rename</span>(<span class="params">self</span>):</span><br><span class="line">        filelist1 = os.listdir(self.path1)</span><br><span class="line">        filelist1.sort()</span><br><span class="line">        total_num1 = <span class="built_in">len</span>(filelist1)</span><br><span class="line">        i1 = <span class="number">1</span></span><br><span class="line">        srcpath1 = os.path.abspath(self.path1)</span><br><span class="line">        <span class="keyword">for</span> item1 <span class="keyword">in</span> filelist1:</span><br><span class="line">            os.rename(os.path.join(srcpath1, item1), os.path.join(srcpath1, <span class="built_in">str</span>(i1).zfill(<span class="number">5</span>) + <span class="string">&#x27;.jpg&#x27;</span>))</span><br><span class="line">            i1 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        filelist2 = os.listdir(self.path2)</span><br><span class="line">        filelist2.sort()</span><br><span class="line">        total_num2 = <span class="built_in">len</span>(filelist2)</span><br><span class="line">        i2 = <span class="number">1</span></span><br><span class="line">        srcpath2 = os.path.abspath(self.path2)</span><br><span class="line">        <span class="keyword">for</span> item2 <span class="keyword">in</span> filelist2:</span><br><span class="line">            os.rename(os.path.join(srcpath2, item2), os.path.join(srcpath2, <span class="built_in">str</span>(i2).zfill(<span class="number">5</span>) + <span class="string">&#x27;.xml&#x27;</span>))</span><br><span class="line">            i2 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    demo = BatchRename()</span><br><span class="line">    demo.rename()</span><br></pre></td></tr></table></figure><h3 id="修改标注文件中的图片路径为本目录下"><a href="#修改标注文件中的图片路径为本目录下" class="headerlink" title="修改标注文件中的图片路径为本目录下"></a>修改标注文件中的图片路径为本目录下</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FilesChange</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.path = <span class="string">&#x27;./Annotations&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Change</span>(<span class="params">self</span>):</span><br><span class="line">        filelist = os.listdir(self.path)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> filelist:</span><br><span class="line">            srcfile = os.path.join(os.path.abspath(self.path), item)</span><br><span class="line">            item = item.rstrip(<span class="string">&#x27;.xml&#x27;</span>)</span><br><span class="line">            item = item.zfill(<span class="number">5</span>)</span><br><span class="line">            line_replace = <span class="number">2</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(srcfile,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">                lines = fd.readlines()</span><br><span class="line">            lines[line_replace] = (<span class="string">&#x27;        &lt;filename&gt;&#x27;</span> + item + <span class="string">&#x27;.jpg&lt;/filename&gt;\n&#x27;</span>)</span><br><span class="line">            lines[line_replace + <span class="number">1</span>] = (<span class="string">&#x27;        &lt;path&gt;&#x27;</span> + <span class="built_in">format</span>(srcfile[:-<span class="number">21</span>]) + <span class="string">&#x27;JPEGImages/&#x27;</span> + item + <span class="string">&#x27;.webp&lt;/path&gt;\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(srcfile,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">                fd.writelines(lines)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    demo = FilesChange()</span><br><span class="line">    demo.Change()</span><br></pre></td></tr></table></figure><h3 id="输出没有标注的图片和标注文件名到-txt-文件"><a href="#输出没有标注的图片和标注文件名到-txt-文件" class="headerlink" title="输出没有标注的图片和标注文件名到 txt 文件"></a>输出没有标注的图片和标注文件名到 txt 文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys,re</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppleSearch</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.path = <span class="string">&#x27;./Annotations&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Search</span>(<span class="params">self</span>):</span><br><span class="line">        filetxt = <span class="string">&#x27;NoAppleXml.txt&#x27;</span></span><br><span class="line">        txtlist = []</span><br><span class="line">        filelist = os.listdir(self.path)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> filelist:</span><br><span class="line">            srcfile = os.path.join(os.path.abspath(self.path), item)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(srcfile,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">                content = fd.read()</span><br><span class="line">                target = re.findall(<span class="string">&quot;apple&quot;</span>, content)</span><br><span class="line">            <span class="keyword">if</span> target == []:</span><br><span class="line">                txtlist.append(item.rstrip(<span class="string">&#x27;.xml&#x27;</span>))</span><br><span class="line">        txtpath = os.path.join(os.path.abspath(<span class="string">&#x27;./&#x27;</span>), filetxt)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(txtpath,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> txtlist:</span><br><span class="line">                <span class="built_in">print</span>(i)</span><br><span class="line">                fd.write(<span class="string">&quot;&#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(i)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    demo = AppleSearch()</span><br><span class="line">    demo.Search()</span><br></pre></td></tr></table></figure><h3 id="从-txt-文件读取要删除的图片和标注文件"><a href="#从-txt-文件读取要删除的图片和标注文件" class="headerlink" title="从 txt 文件读取要删除的图片和标注文件"></a>从 txt 文件读取要删除的图片和标注文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys,fileinput,re</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DeleteNoApple</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.path1 = <span class="string">&#x27;./JPEGImages&#x27;</span></span><br><span class="line">        self.path2 = <span class="string">&#x27;./Annotations&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Delete</span>(<span class="params">self</span>):</span><br><span class="line">        filetxt = <span class="string">&#x27;./NoAppleXml.txt&#x27;</span></span><br><span class="line">        content = []</span><br><span class="line">        txtpath = os.path.join(os.path.abspath(<span class="string">&#x27;./&#x27;</span>), filetxt)</span><br><span class="line">        <span class="comment"># with open(txtpath) as fd:</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> fileinput.<span class="built_in">input</span>(txtpath):</span><br><span class="line">            content.append(line.rstrip(<span class="string">&#x27;\n&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> content:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> content:</span><br><span class="line">                srcpath1 = os.path.join(os.path.abspath(self.path1), i+<span class="string">&#x27;.webp&#x27;</span>)</span><br><span class="line">                os.remove(srcpath1)</span><br><span class="line">                srcpath2 = os.path.join(os.path.abspath(self.path2), i+<span class="string">&#x27;.xml&#x27;</span>)</span><br><span class="line">                os.remove(srcpath2)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    demo = DeleteNoApple()</span><br><span class="line">    demo.Delete()</span><br></pre></td></tr></table></figure><h3 id="批量图片格式转换-（未过滤-jpg-图片防止图片编码错误）"><a href="#批量图片格式转换-（未过滤-jpg-图片防止图片编码错误）" class="headerlink" title="批量图片格式转换 （未过滤 jpg 图片防止图片编码错误）"></a>批量图片格式转换 （未过滤 jpg 图片防止图片编码错误）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">imgList = os.listdir(<span class="string">&#x27;./JPEGImages&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> imgList:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        img = Image.<span class="built_in">open</span>(item)</span><br><span class="line">        file_name, file_type = os.path.splitext(item)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if file_type == &#x27;jpg&#x27;:</span></span><br><span class="line">        <span class="comment">#     continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.save(<span class="string">&quot;%s.webp&quot;</span>%(file_name), <span class="string">&#x27;jpg&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> IOError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;picture convert error&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="批量更改标签名"><a href="#批量更改标签名" class="headerlink" title="批量更改标签名"></a>批量更改标签名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FilesChange</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.path = <span class="string">&#x27;./Annotations&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Change</span>(<span class="params">self</span>):</span><br><span class="line">        old = <span class="string">&quot;Apple&quot;</span></span><br><span class="line">        new = <span class="string">&quot;apple&quot;</span></span><br><span class="line">        filelist = os.listdir(self.path)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> filelist:</span><br><span class="line">            srcfile = os.path.join(os.path.abspath(self.path), item)</span><br><span class="line">            line_replace = <span class="number">2</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(srcfile,<span class="string">&#x27;r+&#x27;</span>) <span class="keyword">as</span> fd:</span><br><span class="line">                lines = fd.readlines()</span><br><span class="line">                fd.seek(<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                    <span class="keyword">if</span> old <span class="keyword">in</span> line:</span><br><span class="line">                        lines=<span class="string">&quot;&quot;</span>.join(lines).replace(old,new)</span><br><span class="line">                fd.writelines(<span class="string">&quot;&quot;</span>.join(lines))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    demo = FilesChange()</span><br><span class="line">    demo.Change()</span><br></pre></td></tr></table></figure><h3 id="查找无对应图片的标签-和-无对应标签的图片"><a href="#查找无对应图片的标签-和-无对应标签的图片" class="headerlink" title="查找无对应图片的标签 和 无对应标签的图片"></a>查找无对应图片的标签 和 无对应标签的图片</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">path1 = <span class="string">r&#x27;./JPEGImages&#x27;</span></span><br><span class="line">path2 = <span class="string">r&#x27;./Annotations&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_name</span>(<span class="params">image_dir,xml_dir</span>):</span><br><span class="line">    jpg_list = []</span><br><span class="line">    xml_list = []</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(image_dir):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            jpg_list.append(os.path.splitext(file)[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(xml_dir):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            xml_list.append(os.path.splitext(file)[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(jpg_list))</span><br><span class="line">    diff = <span class="built_in">set</span>(xml_list).difference(<span class="built_in">set</span>(jpg_list))  <span class="comment"># 差集，在a中但不在b中的元素</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> diff:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no jpg&quot;</span>, name + <span class="string">&quot;.xml&quot;</span>)</span><br><span class="line">    diff2 = <span class="built_in">set</span>(jpg_list).difference(<span class="built_in">set</span>(xml_list))  <span class="comment"># 差集，在b中但不在a中的元素</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(diff2))</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> diff2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;no xml&quot;</span>, name + <span class="string">&quot;.webp&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    file_name(path1,path2)</span><br></pre></td></tr></table></figure><h3 id="使用-imgaug-库图像增广"><a href="#使用-imgaug-库图像增广" class="headerlink" title="使用 imgaug 库图像增广"></a>使用 <code>imgaug</code> 库图像增广</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> getcwd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> imgaug <span class="keyword">as</span> ia</span><br><span class="line"><span class="keyword">from</span> imgaug <span class="keyword">import</span> augmenters <span class="keyword">as</span> iaa</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFile</span><br><span class="line"></span><br><span class="line">ImageFile.LOAD_TRUNCATED_IMAGES = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ia.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_xml_annotation</span>(<span class="params">root, image_id</span>):</span><br><span class="line">    in_file = <span class="built_in">open</span>(os.path.join(root, image_id))</span><br><span class="line">    tree = ET.parse(in_file)</span><br><span class="line">    root = tree.getroot()</span><br><span class="line">    bndboxlist = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">object</span> <span class="keyword">in</span> root.findall(<span class="string">&#x27;object&#x27;</span>):  <span class="comment"># 找到root节点下的所有country节点</span></span><br><span class="line">        bndbox = <span class="built_in">object</span>.find(<span class="string">&#x27;bndbox&#x27;</span>)  <span class="comment"># 子节点下节点rank的值</span></span><br><span class="line"></span><br><span class="line">        xmin = <span class="built_in">int</span>(<span class="built_in">float</span>(bndbox.find(<span class="string">&#x27;xmin&#x27;</span>).text))</span><br><span class="line">        xmax = <span class="built_in">int</span>(<span class="built_in">float</span>(bndbox.find(<span class="string">&#x27;xmax&#x27;</span>).text))</span><br><span class="line">        ymin = <span class="built_in">int</span>(<span class="built_in">float</span>(bndbox.find(<span class="string">&#x27;ymin&#x27;</span>).text))</span><br><span class="line">        ymax = <span class="built_in">int</span>(<span class="built_in">float</span>(bndbox.find(<span class="string">&#x27;ymax&#x27;</span>).text))</span><br><span class="line">        <span class="comment"># print(xmin,ymin,xmax,ymax)</span></span><br><span class="line">        bndboxlist.append([xmin,ymin,xmax,ymax])</span><br><span class="line">        <span class="comment"># print(bndboxlist)</span></span><br><span class="line"></span><br><span class="line">    bndbox = root.find(<span class="string">&#x27;object&#x27;</span>).find(<span class="string">&#x27;bndbox&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> bndboxlist</span><br><span class="line"><span class="comment"># (506.0000, 330.0000, 528.0000, 348.0000) -&gt; (520.4747, 381.5080, 540.5596, 398.6603)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_xml_annotation</span>(<span class="params">root, image_id, new_target</span>):</span><br><span class="line">    new_xmin = new_target[<span class="number">0</span>]</span><br><span class="line">    new_ymin = new_target[<span class="number">1</span>]</span><br><span class="line">    new_xmax = new_target[<span class="number">2</span>]</span><br><span class="line">    new_ymax = new_target[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    in_file = <span class="built_in">open</span>(os.path.join(root, <span class="built_in">str</span>(image_id) + <span class="string">&#x27;.xml&#x27;</span>))  <span class="comment"># 这里root分别由两个意思</span></span><br><span class="line">    tree = ET.parse(in_file)</span><br><span class="line">    xmlroot = tree.getroot()</span><br><span class="line">    <span class="built_in">object</span> = xmlroot.find(<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">    bndbox = <span class="built_in">object</span>.find(<span class="string">&#x27;bndbox&#x27;</span>)</span><br><span class="line">    xmin = bndbox.find(<span class="string">&#x27;xmin&#x27;</span>)</span><br><span class="line">    xmin.text = <span class="built_in">str</span>(new_xmin)</span><br><span class="line">    ymin = bndbox.find(<span class="string">&#x27;ymin&#x27;</span>)</span><br><span class="line">    ymin.text = <span class="built_in">str</span>(new_ymin)</span><br><span class="line">    xmax = bndbox.find(<span class="string">&#x27;xmax&#x27;</span>)</span><br><span class="line">    xmax.text = <span class="built_in">str</span>(new_xmax)</span><br><span class="line">    ymax = bndbox.find(<span class="string">&#x27;ymax&#x27;</span>)</span><br><span class="line">    ymax.text = <span class="built_in">str</span>(new_ymax)</span><br><span class="line">    tree.write(os.path.join(root, <span class="built_in">str</span>(image_id) + <span class="string">&quot;_aug&quot;</span> + <span class="string">&#x27;.xml&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_xml_list_annotation</span>(<span class="params">root, image_id, new_target,saveroot,<span class="built_in">id</span></span>):</span><br><span class="line"></span><br><span class="line">    in_file = <span class="built_in">open</span>(os.path.join(root, <span class="built_in">str</span>(image_id) + <span class="string">&#x27;.xml&#x27;</span>))  <span class="comment"># 这里root分别由两个意思</span></span><br><span class="line">    tree = ET.parse(in_file)</span><br><span class="line">    xmlroot = tree.getroot()</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">object</span> <span class="keyword">in</span> xmlroot.findall(<span class="string">&#x27;object&#x27;</span>):  <span class="comment"># 找到root节点下的所有country节点</span></span><br><span class="line">        bndbox = <span class="built_in">object</span>.find(<span class="string">&#x27;bndbox&#x27;</span>)  <span class="comment"># 子节点下节点rank的值</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># xmin = int(bndbox.find(&#x27;xmin&#x27;).text)</span></span><br><span class="line">        <span class="comment"># xmax = int(bndbox.find(&#x27;xmax&#x27;).text)</span></span><br><span class="line">        <span class="comment"># ymin = int(bndbox.find(&#x27;ymin&#x27;).text)</span></span><br><span class="line">        <span class="comment"># ymax = int(bndbox.find(&#x27;ymax&#x27;).text)</span></span><br><span class="line"></span><br><span class="line">        new_xmin = new_target[index][<span class="number">0</span>]</span><br><span class="line">        new_ymin = new_target[index][<span class="number">1</span>]</span><br><span class="line">        new_xmax = new_target[index][<span class="number">2</span>]</span><br><span class="line">        new_ymax = new_target[index][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        xmin = bndbox.find(<span class="string">&#x27;xmin&#x27;</span>)</span><br><span class="line">        xmin.text = <span class="built_in">str</span>(new_xmin)</span><br><span class="line">        ymin = bndbox.find(<span class="string">&#x27;ymin&#x27;</span>)</span><br><span class="line">        ymin.text = <span class="built_in">str</span>(new_ymin)</span><br><span class="line">        xmax = bndbox.find(<span class="string">&#x27;xmax&#x27;</span>)</span><br><span class="line">        xmax.text = <span class="built_in">str</span>(new_xmax)</span><br><span class="line">        ymax = bndbox.find(<span class="string">&#x27;ymax&#x27;</span>)</span><br><span class="line">        ymax.text = <span class="built_in">str</span>(new_ymax)</span><br><span class="line"></span><br><span class="line">        index = index + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    tree.write(os.path.join(saveroot, <span class="built_in">str</span>(image_id) + <span class="string">&quot;_aug_&quot;</span> + <span class="built_in">str</span>(<span class="built_in">id</span>) + <span class="string">&#x27;.xml&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mkdir</span>(<span class="params">path</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 去除首位空格</span></span><br><span class="line">    path = path.strip()</span><br><span class="line">    <span class="comment"># 去除尾部 \ 符号</span></span><br><span class="line">    path = path.rstrip(<span class="string">&quot;\\&quot;</span>)</span><br><span class="line">    <span class="comment"># 判断路径是否存在</span></span><br><span class="line">    <span class="comment"># 存在     True</span></span><br><span class="line">    <span class="comment"># 不存在   False</span></span><br><span class="line">    isExists = os.path.exists(path)</span><br><span class="line">    <span class="comment"># 判断结果</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isExists:</span><br><span class="line">        <span class="comment"># 如果不存在则创建目录</span></span><br><span class="line">         <span class="comment"># 创建目录操作函数</span></span><br><span class="line">        os.makedirs(path)</span><br><span class="line">        <span class="built_in">print</span>(path + <span class="string">&#x27; 创建成功&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 如果目录存在则不创建，并提示目录已存在</span></span><br><span class="line">        <span class="built_in">print</span>(path + <span class="string">&#x27; 目录已存在&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    IMG_DIR = <span class="string">&quot;./JPEGImages&quot;</span></span><br><span class="line">    XML_DIR = <span class="string">&quot;./Annotations&quot;</span></span><br><span class="line"></span><br><span class="line">    AUG_XML_DIR = <span class="string">&quot;./aug_Annotations&quot;</span>  <span class="comment"># 存储增强后的XML文件夹路径</span></span><br><span class="line">    mkdir(AUG_XML_DIR)</span><br><span class="line"></span><br><span class="line">    AUG_IMG_DIR = <span class="string">&quot;./aug_JPEGImages&quot;</span>  <span class="comment"># 存储增强后的影像文件夹路径</span></span><br><span class="line">    mkdir(AUG_IMG_DIR)</span><br><span class="line"></span><br><span class="line">    AUGLOOP = <span class="number">2</span> <span class="comment"># 每张影像增强的数量</span></span><br><span class="line"></span><br><span class="line">    boxes_img_aug_list = []</span><br><span class="line">    new_bndbox = []</span><br><span class="line">    new_bndbox_list = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 影像增强</span></span><br><span class="line">    seq = iaa.Sequential([</span><br><span class="line">        <span class="comment"># iaa.Flipud(0.5),  # vertically flip 20% of all images</span></span><br><span class="line">        iaa.Fliplr(<span class="number">0.5</span>),  <span class="comment"># 镜像</span></span><br><span class="line">        iaa.Multiply((<span class="number">1.2</span>, <span class="number">1.5</span>)),  <span class="comment"># change brightness, doesn&#x27;t affect BBs</span></span><br><span class="line">        iaa.GaussianBlur(sigma=(<span class="number">0</span>, <span class="number">3.0</span>)), <span class="comment"># iaa.GaussianBlur(0.5),</span></span><br><span class="line">        iaa.Affine(</span><br><span class="line">            translate_px=&#123;<span class="string">&quot;x&quot;</span>: <span class="number">15</span>, <span class="string">&quot;y&quot;</span>: <span class="number">15</span>&#125;,</span><br><span class="line">            scale=(<span class="number">0.8</span>, <span class="number">0.95</span>),</span><br><span class="line">            rotate=(-<span class="number">30</span>, <span class="number">30</span>)</span><br><span class="line">        )  <span class="comment"># translate by 40/60px on x/y axis, and scale to 50-70%, affects BBs</span></span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> root, sub_folders, files <span class="keyword">in</span> os.walk(XML_DIR):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> files:</span><br><span class="line"></span><br><span class="line">            bndbox = read_xml_annotation(XML_DIR, name)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(AUGLOOP):</span><br><span class="line">                seq_det = seq.to_deterministic()  <span class="comment"># 保持坐标和图像同步改变，而不是随机</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># 读取图片</span></span><br><span class="line">                img = Image.<span class="built_in">open</span>(os.path.join(IMG_DIR, name[:-<span class="number">4</span>] + <span class="string">&#x27;.webp&#x27;</span>))</span><br><span class="line">                img = np.array(img)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># bndbox 坐标增强</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bndbox)):</span><br><span class="line">                    bbs = ia.BoundingBoxesOnImage([</span><br><span class="line">                        ia.BoundingBox(x1=bndbox[i][<span class="number">0</span>], y1=bndbox[i][<span class="number">1</span>], x2=bndbox[i][<span class="number">2</span>], y2=bndbox[i][<span class="number">3</span>]),</span><br><span class="line">                    ], shape=img.shape)</span><br><span class="line"></span><br><span class="line">                    bbs_aug = seq_det.augment_bounding_boxes([bbs])[<span class="number">0</span>]</span><br><span class="line">                    boxes_img_aug_list.append(bbs_aug)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># new_bndbox_list:[[x1,y1,x2,y2],...[],[]]</span></span><br><span class="line">                    new_bndbox_list.append([<span class="built_in">int</span>(bbs_aug.bounding_boxes[<span class="number">0</span>].x1),</span><br><span class="line">                                            <span class="built_in">int</span>(bbs_aug.bounding_boxes[<span class="number">0</span>].y1),</span><br><span class="line">                                            <span class="built_in">int</span>(bbs_aug.bounding_boxes[<span class="number">0</span>].x2),</span><br><span class="line">                                            <span class="built_in">int</span>(bbs_aug.bounding_boxes[<span class="number">0</span>].y2)])</span><br><span class="line">                <span class="comment"># 存储变化后的图片</span></span><br><span class="line">                image_aug = seq_det.augment_images([img])[<span class="number">0</span>]</span><br><span class="line">                path = os.path.join(AUG_IMG_DIR, <span class="built_in">str</span>(name[:-<span class="number">4</span>]) + <span class="string">&quot;_aug_&quot;</span> + <span class="built_in">str</span>(epoch) + <span class="string">&#x27;.webp&#x27;</span>)</span><br><span class="line">                <span class="comment"># image_auged = bbs.draw_on_image(image_aug, thickness=0)</span></span><br><span class="line">                Image.fromarray(image_aug).save(path)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 存储变化后的XML</span></span><br><span class="line">                change_xml_list_annotation(XML_DIR, name[:-<span class="number">4</span>], new_bndbox_list,AUG_XML_DIR,epoch)</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(name[:-<span class="number">4</span>]) + <span class="string">&quot;_aug_&quot;</span> + <span class="built_in">str</span>(epoch) + <span class="string">&#x27;.webp&#x27;</span>)</span><br><span class="line">                new_bndbox_list = []</span><br></pre></td></tr></table></figure></div><footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="tag">数据集</a></li></ul><div style="text-align:center;color:#ccc;font-size:14px">- ETX &nbsp;<i class="fe fe-smile"></i>&nbsp;Thank you for reading -</div><div><ul class="post-copyright"><li class="post-copyright-license"><strong>Copyright: </strong>All posts on this blog except otherwise stated, All adopt <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a> license agreement. Please indicate the source of reprint!</li></ul><div></div></div></footer></div><nav class="article-nav"><a href="/2022/04/13/%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0%E5%86%85%E5%AD%98%E7%9A%84%E5%88%86%E9%85%8D%E5%92%8C%E5%9B%9E%E6%94%B6%E7%AE%97%E6%B3%95/" class="article-nav-link"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">设计实现内存的分配和回收算法</div></a><a href="/2022/03/30/Faster-RCNN%E5%8E%9F%E7%90%86%E7%AC%94%E8%AE%B0/" class="article-nav-link"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">Faster-RCNN原理笔记</div></a></nav><div class="gitalk" id="gitalk-container"></div><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script><script type="text/javascript">var gitalk=new Gitalk({clientID:"1eb16485d4cf892a21bb",clientSecret:"d134888956393ad07790db31a3c50eea40618d43",repo:"gitalkIssue",owner:"aeeeeeep",admin:["aeeeeeep"],id:md5(location.pathname),distractionFreeMode:!1,pagerDirection:"last"});gitalk.render("gitalk-container")</script></article></section><footer class="footer"><div class="outer"><div class="float-right"><div class="powered-by">&emsp;<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">Visitors:<span id="busuanzi_value_site_uv"></span></span>&emsp; <i class="fe fe-bookmark"></i>Article Views:<span id="busuanzi_value_page_pv"></span></div></div><ul class="list-inline"><li>Aeeeeeep Blog | The Gleaners &copy; 2023</li><li><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32090202001024" style="display:inline-block;text-decoration:none;height:20px;line-height:20px"><img src="/images/备案图标.png" style="float:left"><p style="float:left;height:20px;line-height:20px;margin:0 0 0 5px;color:#1e3e3f">苏公网安备 32090202001024号</p></a></li></ul><div class="float-left"><span id="timeDate">Loading days...</span><span id="times">Loading hours, minutes, and seconds...</span><script>var now=new Date;function createTime(){var n=new Date("11/11/2021 00:08:39");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="Site has been running for "+dnum+" d ",document.getElementById("times").innerHTML=hnum+" h "+mnum+" m "+snum+" s "}setInterval(createTime,250)</script></div></div></footer></main><aside class="sidebar"><button class="navbar-toggle"></button><nav class="navbar"><div class="logo"><a href="/"><img src="/images/aepBlack.svg" alt="Aeeeeeep Blog | The Gleaners"></a></div><ul class="nav nav-main"><li class="nav-item"><a class="nav-item-link" href="/">Home</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">Archives</a></li><li class="nav-item"><a class="nav-item-link" href="/links">Links</a></li><li class="nav-item"><a class="nav-item-link" href="/about">About</a></li><li class="nav-item"><a class="nav-item-link nav-item-search" title="Search"><i class="fe fe-search"></i> Search</a></li></ul></nav><nav class="navbar navbar-bottom"><ul class="nav"><li class="nav-item"><div class="totop" id="totop"><i class="fe fe-rocket"></i></div></li><li class="nav-item"></li></ul></nav><div class="search-form-wrap"><div class="local-search local-search-plugin"><input type="search" id="local-search-input" class="local-search-input" placeholder="Search..."><div id="local-search-result" class="local-search-result"></div></div></div></aside><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/jquery.justifiedGallery.min.js"></script><script src="/js/lazyload.min.js"></script><script src="/js/busuanzi-2.3.pure.min.js"></script><script src="/fancybox/jquery.fancybox.min.js"></script><script src="/js/copybtn.js"></script><script src="/js/tocbot.min.js"></script><script>tocbot.init({tocSelector:".tocbot",contentSelector:".article-entry",headingSelector:"h1, h2, h3, h4, h5, h6",hasInnerContainers:!0,scrollSmooth:!0,positionFixedSelector:".tocbot",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"})</script><script src="/js/ocean.js"></script><script src="/js/cursor.js"></script></body></html>